{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "dropzone",
  "type": "registry:component",
  "title": "Dropzone",
  "description": "A dropzone component",
  "dependencies": ["react-dropzone", "lucide-react"],
  "registryDependencies": ["button"],
  "files": [
    {
      "path": "registry/components/dropzone.tsx",
      "content": "'use client';\nimport type { FC, ReactNode } from 'react';\nimport { createContext, useContext } from 'react';\nimport type { DropEvent, DropzoneOptions, FileRejection } from 'react-dropzone';\nimport { useDropzone } from 'react-dropzone';\nimport { UploadIcon } from 'lucide-react';\n\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\ninterface DropzoneContextType {\n  src?: Array<File>;\n  accept?: DropzoneOptions['accept'];\n  maxSize?: DropzoneOptions['maxSize'];\n  minSize?: DropzoneOptions['minSize'];\n  maxFiles?: DropzoneOptions['maxFiles'];\n}\nconst renderBytes = (bytes: number) => {\n  const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB'];\n  let size = bytes;\n  let unitIndex = 0;\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex++;\n  }\n  return `${size.toFixed(2)}${units[unitIndex]}`;\n};\nconst DropzoneContext = createContext<DropzoneContextType | undefined>(\n  undefined\n);\nconst useDropzoneContext = () => {\n  const context = useContext(DropzoneContext);\n  if (!context) {\n    throw new Error('useDropzoneContext must be used within a Dropzone');\n  }\n  return context;\n};\nexport type DropzoneProps = Omit<DropzoneOptions, 'onDrop'> & {\n  src?: Array<File>;\n  className?: string;\n  onDrop?: (\n    acceptedFiles: Array<File>,\n    fileRejections: Array<FileRejection>,\n    event: DropEvent\n  ) => void;\n  children?: ReactNode;\n};\nconst Dropzone: FC<DropzoneProps> = ({\n  accept,\n  maxFiles = 1,\n  maxSize,\n  minSize,\n  onDrop,\n  onError,\n  disabled,\n  src,\n  className,\n  children,\n  ...props\n}) => {\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    accept,\n    maxFiles,\n    maxSize,\n    minSize,\n    onError,\n    disabled,\n    onDrop: (acceptedFiles, fileRejections, event) => {\n      if (fileRejections.length > 0) {\n        const message = fileRejections.at(0)?.errors.at(0)?.message;\n        onError?.(new Error(message));\n        return;\n      }\n      onDrop?.(acceptedFiles, fileRejections, event);\n    },\n    ...props,\n  });\n  return (\n    <DropzoneContext.Provider\n      key={JSON.stringify(src)}\n      value={{ src, accept, maxSize, minSize, maxFiles }}>\n      <Button\n        className={cn(\n          'relative h-auto w-full flex-col overflow-hidden p-8',\n          isDragActive && 'outline-none ring-1 ring-ring',\n          className\n        )}\n        disabled={disabled}\n        type='button'\n        variant='outline'\n        {...getRootProps()}>\n        <input\n          {...getInputProps()}\n          disabled={disabled}\n        />\n        {children}\n      </Button>\n    </DropzoneContext.Provider>\n  );\n};\n\nexport interface DropzoneContentProps {\n  children?: ReactNode;\n  className?: string;\n}\nconst maxLabelItems = 3;\n\nconst DropzoneContent: FC<DropzoneContentProps> = ({ children, className }) => {\n  const { src } = useDropzoneContext();\n  if (!src) {\n    return null;\n  }\n  if (children) {\n    return <>{children}</>;\n  }\n  return (\n    <div className={cn('flex flex-col items-center justify-center', className)}>\n      <div className='flex size-8 items-center justify-center rounded-md bg-muted text-muted-foreground'>\n        <UploadIcon size={16} />\n      </div>\n      <p className='my-2 w-full truncate font-medium text-sm'>\n        {src.length > maxLabelItems\n          ? `${new Intl.ListFormat('en').format(\n              src.slice(0, maxLabelItems).map((file) => file.name)\n            )} and ${src.length - maxLabelItems} more`\n          : new Intl.ListFormat('en').format(src.map((file) => file.name))}\n      </p>\n      <p className='w-full text-wrap text-muted-foreground text-xs'>\n        Drag and drop or click to replace\n      </p>\n    </div>\n  );\n};\nexport interface DropzoneEmptyStateProps {\n  children?: ReactNode;\n  className?: string;\n}\nconst DropzoneEmptyState: FC<DropzoneEmptyStateProps> = ({\n  children,\n  className,\n}) => {\n  const { src, accept, maxSize, minSize, maxFiles } = useDropzoneContext();\n  if (src) {\n    return null;\n  }\n  if (children) {\n    return <>{children}</>;\n  }\n  let caption = '';\n  if (accept) {\n    caption += 'Accepts ';\n    caption += new Intl.ListFormat('en').format(Object.keys(accept));\n  }\n  if (minSize && maxSize) {\n    caption += ` between ${renderBytes(minSize)} and ${renderBytes(maxSize)}`;\n  } else if (minSize) {\n    caption += ` at least ${renderBytes(minSize)}`;\n  } else if (maxSize) {\n    caption += ` less than ${renderBytes(maxSize)}`;\n  }\n  return (\n    <div className={cn('flex flex-col items-center justify-center', className)}>\n      <div className='flex size-8 items-center justify-center rounded-md bg-muted text-muted-foreground'>\n        <UploadIcon size={16} />\n      </div>\n      <p className='my-2 w-full truncate text-wrap font-medium text-sm'>\n        Upload {maxFiles === 1 ? 'a file' : 'files'}\n      </p>\n      <p className='w-full truncate text-wrap text-muted-foreground text-xs'>\n        Drag and drop or click to upload\n      </p>\n      {caption && (\n        <p className='text-wrap text-muted-foreground text-xs'>{caption}.</p>\n      )}\n    </div>\n  );\n};\n\ninterface DropzoneComposition {\n  Content: typeof DropzoneContent;\n  EmptyState: typeof DropzoneEmptyState;\n}\nconst RootWithComposition: typeof Dropzone & DropzoneComposition =\n  Object.assign(Dropzone, {\n    Content: DropzoneContent,\n    EmptyState: DropzoneEmptyState,\n  });\n\nexport { RootWithComposition as Dropzone };\n",
      "type": "registry:component"
    }
  ],
  "categories": ["forms"]
}
